llvm_externals_find(TEST_SUITE_HMMER_ROOT "hmmer" "HMMER 2.3.2")

if(TEST_SUITE_HMMER_ROOT)
  set(PROG hmmcalibrate)
  FILE(GLOB Source ${TEST_SUITE_HMMER_ROOT}/*.c)
  list(APPEND CFLAGS -pthread)
  list(APPEND LDFLAGS -pthread)
  if(ARCH STREQUAL "PowerPC")
    list(APPEND TARGET_FLAGS -maltivec)
    list(APPEND LCCFLAGS -maltivec)
  endif()
  if(ARCH STREQUAL "x86")
    add_definitions(-DSSE2)
  endif()

  if(DEFINED LARGE_PROBLEM_SIZE)
    llvm_test_run(--fixed 400 --cpu 1 --num 200000 --seed 1158818515 ${TEST_SUITE_HMMER_ROOT}/globin.hmm)
  else()
    llvm_test_run(--fixed 400 --cpu 1 --num 80000 --seed 1158818515 ${TEST_SUITE_HMMER_ROOT}/globin.hmm)
  endif()
  llvm_multisource()
endif()
